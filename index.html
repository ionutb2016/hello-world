<html>
<head>
<title>aplicatia de aur</title>
<meta http-equiv="Content-Security-Policy" content="default-src *; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' 'unsafe-eval'">
<script src="js/jquery.min.js"></script>

<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="css/bootstrap.min.css">
<link rel="stylesheet" href="css/main.css">
<!-- Latest compiled and minified JavaScript -->
<script src="js/bootstrap.min.js"></script>  

  <!-- Compiled and minified CSS <link rel="stylesheet" href="css/materialize.min.css">-->
  

  <!-- Compiled and minified JavaScript <script src="js/materialize.min.js"></script>-->
   

</head>

<body>
  <div id="wrapper"> 
    <div class="container">   
      <div class="row"> 
        <div id="loginbox" style="margin-top:50px;" class="mainbox col-md-6 col-md-offset-3 col-sm-8 col-sm-offset-2">                    
            <div class="panel panel-info" >
                    <div class="panel-heading">
                        <div class="panel-title">Sign In</div>
                        <div style="float:right; font-size: 80%; position: relative; top:-10px"><a href="#">Forgot password?</a></div>
                    </div>     

                    <div style="padding-top:30px" class="panel-body" >
                            
                        <form id="loginform" class="form-horizontal validateDontSubmit" role="form">
                                    
                            <div style="margin-bottom: 30px" class="input-field">
                                        <i class="material-icons prefix glyphicon glyphicon-user"></i>
                                        <input id="login-username" type="text" class="form-control" name="username" value="" required>
                                        <label for="login-username">username or email</label>                                       
                                    </div>
                                
                            <div style="margin-bottom: 30px" class="input-field">
                                        <i class="material-icons prefix glyphicon glyphicon-lock"></i>
                                        <input id="login-password" type="password" class="form-control" name="password" required>
                                        <label for="login-password">password</label>
                                    </div>

                                <div style="margin-top:20px;margin-bottom:35px" class="form-group">

                                    <div class="col-sm-12 controls text-center">
                                      <input type="hidden" name="action" value="login">
                                      <button id="btn-login" class="btn btn-default waves-effect waves-light">Login  </button>

                                    </div>
                                </div>


                                <div class="form-group">
                                    <div class="col-md-12 control">
                                        <div style="border-top: 1px solid#888; padding-top:25px; font-size:85%" >
                                            Don't have an account! 
                                        <a href="#" onClick="$('#loginbox').hide(); $('#signupbox').show()">
                                            Sign Up Here
                                        </a>
                                        </div>
                                    </div>
                                </div>    
                            </form>     



                        </div>                     
                    </div>  
        </div>
      </div>

        <div id="signupbox" style="display:none; margin-top:50px" class="mainbox col-md-6 col-md-offset-3 col-sm-8 col-sm-offset-2">
                    <div class="panel panel-info">
                        <div class="panel-heading">
                            <div class="panel-title">Sign Up</div>
                            <div style="float:right; font-size: 85%; position: relative; top:-10px"><a id="signinlink" href="#" onclick="$('#signupbox').hide(); $('#loginbox').show()">Sign In</a></div>
                        </div>  
                        <div class="panel-body" >
                            <form id="signupform" class="form-horizontal  validateDontSubmit" role="form">
                                 
                                <div class="form-group">
                                    
                                    <div class="col-md-12 input-field">
                                        <input id="register-email" type="text" class="form-control" name="email"  value="" required>
                                        <label for="email">Email</label>
                                    </div>
                                </div>
                                    
                                <div class="form-group">
                                    
                                    <div class="col-md-12 input-field">
                                        <input id="register-firstname" type="text" class="form-control" name="firstname"  value="" required>
                                        <label for="firstname" >First Name</label>
                                    </div>
                                </div>
                                <div class="form-group">
                                    
                                    <div class="col-md-12 input-field">
                                        <input id="register-lastname" type="text" class="form-control" name="lastname"  value="" required>
                                        <label for="lastname">Last Name</label>
                                    </div>
                                </div>
                                <div class="form-group">
                                    
                                    <div class="col-md-12 input-field">
                                        <input id="register-password" type="password" class="form-control" name="passwd" value="" required>
                                        <label for="password">Password</label>
                                    </div>
                                </div>
                                    
                                <div class="form-group">
                                    
                                    <div class="col-md-12 input-field">
                                        <input id="register-icode" type="text" class="form-control" name="icode" value="">
                                        <label for="icode">Invitation Code (optional)</label>
                                    </div>
                                </div>

                                <div class="form-group">
                                        
                                    <div class="col-md-offset-3 col-md-12">
                                      <input type="hidden" name="action" value="register">
                                        <button id="btn-signup" class="btn btn-default waves-effect waves-light"><i class="icon-hand-right"></i> &nbsp Sign Up</button>
                                        <span style="margin-left:8px;">or</span>
                                        <button id="btn-fbsignup" type="button" class="btn btn-default"  onclick="$('#signupbox').hide(); $('#loginbox').show()">Back to login</button>  
                                    </div>
                                </div>
                               
                            </form>
                         </div>
                    </div>
        </div> 
        <div id="cursuri" class="row">
        </div>




    </div><!-- end container -->
</div><!-- end wrapper -->




<script>

function afiseaza_rezultatele(obiect) {
  $('#loginbox').hide();
  $('#signupbox').addClass('hidden');

  
  $.each(obiect,function(key,value){
    //console.log(key + "---" + value.clasa);
    if (key != 0) {
    var untext = "<div class='col-sm-12'><div class='grupe " + value.clasa + "'><div class='textG'>" + value.titlu + "</div><div class='grupetext'><strong>Data incepere: <span class='culoare_curs'>" + value.data_incepere +"</span></strong><br/></div><div class='infoG'> Program: " + value.program + " <br/>Pret: " + value.pret + " lei<br/>Sala de curs: " + value.sala + "</div><div class='locuri_tabel'>Mai sunt: <br/>" + value.locuri + "</div></div></div>";

    $('#cursuri').append(untext);
    //console.log(untext);
    }
  });


  $('#cursuri').fadeIn('slow');
}



function ajaxcall(e, datele) {
    e.preventDefault();

            
            
            $.ajax({
              url: 'http://scripting.work/api/inscrieri_api.php',
              dataType:'jsonp',
              type: "GET",
              jsonp: "callback",
              data: datele,
              success: function(data, textStatus, xhr) {
                  alert(data);
                  
                  var stringy = JSON.stringify(data);
                  var obj = jQuery.parseJSON( stringy );
                  
                  
                  if (obj.mesaj == 'gogogo') {
                    afiseaza_rezultatele(obj);
                  }
                  else {
                    //console.log(obj);
                    alert(obj.mesaj);
                    //Materialize.toast(obj.mesaj, 4000) // 4000 is the duration of the toast
                  }        
                },
              complete: function(xhr, textStatus) {
                    alert(xhr.status);
                }, 
              error: function(xhr, desc, err) {
                //alert(xhr);
                alert("Details: " + desc + "\nError:" + err);
              }
            }); // end ajax call
}


$(document).ready(function() {
    $('#cursuri').hide();

    $(document).on('submit','.validateDontSubmit',function (e) {
        //prevent the form from doing a submit
        e.preventDefault();
        return false;
    });





    $('#btn-login').click(function(e){
      //Leverage the HTML5 validation w/ ajax. Have to submit to get em. Wont actually submit cuz form
      //has .validateDontSubmit class
      var $theForm = $(this).closest('form');
      //Some browsers don't implement checkValidity
      if (( typeof($theForm[0].checkValidity) == "function" ) && !$theForm[0].checkValidity()) {

         return;
      } else {
      //here comes ajax call and answer*/
            var actiunea = $theForm.find('input[name=action]').val();
            var userul = $('#login-username').val();
            var passul = $('#login-password').val();

            var data = {'actiunea': actiunea, 'username': userul, 'password': passul};
            ajaxcall(e, data);
        }

    });

    $('#btn-signup').click(function(e){
      //Leverage the HTML5 validation w/ ajax. Have to submit to get em. Wont actually submit cuz form
      //has .validateDontSubmit class
      var $theForm = $(this).closest('form');
      //Some browsers don't implement checkValidity
      if (( typeof($theForm[0].checkValidity) == "function" ) && !$theForm[0].checkValidity()) {

         return;
      } else {
      //here comes ajax call and answer*/
            var actiunea = $theForm.find('input[name=action]').val();
            var email = $('#register-email').val();
            var firstname = $('#register-firstname').val();
            var lastname = $('#register-lastname').val();
            var passwd = $('#register-passwd').val();
            var icode = $('#register-icode').val();

            var data = {'actiunea': actiunea, 'email': email, 'firstname': firstname, 'lastname': lastname, 'parola': passwd, 'codul': icode};
            ajaxcall(e, data);
        }

    });

});




</script>
</body>
</html>